<!DOCTYPE html>
<html>
<head>
<title>RSSTag - Tasks</title>
{% include 'head-data.html' %}
</head>
<body>
{% import 'main-menu.html' as menu with context %}{% import 'global-status.html' as g_status with context %}
<noscript>
    <h1>Please enable javascript in your browser</h1>
</noscript>
<div id="global_tools">
    {% include "logo.html" %}
    <div class="panel right_half">
        <span class="login_button global_tools_button">
            <a href="/data-sources">{% if provider %}{{provider}}{% else %}Data sources{% endif %}</a>
        </span>
        {{ g_status.global_status() }}
        {{ menu.settings_menu() }}
    </div>
</div>
<div class="page screen_middle">
    <h1>Tasks Queue</h1>
    
    <div class="tasks-section">
        <h2>Current Tasks</h2>
        {% if current_tasks %}
            <ul class="tasks-list">
            {% for task in current_tasks %}
                <li>
                    {{ task.title }} 
                    {% if task.processing > 0 %}
                        (Processing...)
                    {% endif %}
                    <form action="/tasks/remove/{{ task.id }}" method="post" class="inline-form">
                        <input type="submit" value="Remove" onclick="return confirm('Are you sure?')">
                    </form>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No active tasks.</p>
        {% endif %}
    </div>

    <div class="add-task-section">
        <h2>Add Task</h2>
        <form action="/tasks" method="post">
            <select name="task_type">
                {% for type_id, title in available_tasks.items() %}
                    <option value="{{ type_id }}">{{ title }}</option>
                {% endfor %}
            </select>
            <input type="submit" value="Add Task">
        </form>
    </div>
    
    <div class="root_item"><a href="/">Back to Home</a></div>
</div>

<div id="status" ><span></span></div>
{% include "root-footer.html" %}
<div id="progressbar"></div></body>
</html>
